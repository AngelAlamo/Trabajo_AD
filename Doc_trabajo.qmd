---
title: "Análisis del Dataset Wine Quality"
author: 
  - name: Ángel Álamo
  - name: Juanjo Doblas
  - name: Óscar Vanrell 
format: html
editor: visual
execute:
  echo: false
---

## Introduccción

En este documento se presentará un estudio detallado del Dataset Wine Quality, obtenido de la página web Kaggle y que podéis encontrar en este [enlace](https://www.kaggle.com/datasets/shelvigarg/wine-quality-dataset/). Respecto al estudio, estará enfocado en (???), ya que el objetivo principal de este análisis es dar respuestas a las siguientes cuestiones: (Insertar preguntas aquí).

Una vez explicado el objetivo, mostremos los datos que contiene el Dataset.

## Análisis exploratorio de datos

```{r dataset, echo = FALSE, warnign = FALSE}
library(tidyverse)

wine_base = read_csv(file = "winequality.csv")

wine = wine_base %>% 
  mutate(type = as.factor(type)) %>% 
  mutate(quality = as.ordered(quality))

wine %>% 
  glimpse

```
Las variables que contiene el dataset son:

- type: variable cualitativa binaria que represetna el color del vino. Toma los valores "white" y "red" y sus frecuencias absolutas son:


```{r}
table(wine$type)
```


- fixed acidity (g/L): variable cuantitativa continua que mide la acidez que se encuentra presente de manera natural en el vino. 


```{r}
summary(wine$`fixed acidity`)
```


- volatile acidity (g/L): variable cuantitativa continua que mide la cantidad de ácidos volátiles.


```{r}
summary(wine$`volatile acidity`)
```



- citric acid (g/L): variable cuantitativa continua que representa la cantidad de ácido cítrico en el vino.


```{r}
summary(wine$`citric acid`)
```


- residual sugar (g/L): variable cuantitativa continua que mide el nivel de azúcar que permanece sin fermentar en el vino después del proceso de fermentación alcohólica.


```{r}
summary(wine$`residual sugar`)
```


- chlorides (mg/L): variable cuantitativa continua que representa la concentración de cloruros presentes.


```{r}
summary(wine$chlorides)
```


- free sulfur dioxide (mg/L): variable cuantitativa continua que mide la cantidad de dióxido de azufre que se encuentra en forma libre.


```{r}
summary(wine$`free sulfur dioxide`)
```


- total sulfur dioxide (mg/L): variable cuantitativa continua que representa el dióxido de azufre total presente.


```{r}
summary(wine$`total sulfur dioxide`)
```


- density (g/mL): variable cuantitativa continua que mide la densidad del vino.



```{r}
summary(wine$density)
```


- pH: variable cuantitativa continua que representa el nivel de pH del vino.


```{r}
summary(wine$pH)
```


- sulphates (mg/L): variable cuantitativa continua que mide la presencia de sulfatos en el vino


```{r}
summary(wine$sulphates)
```


- alcohol (g/L): variable cuantitativa continua que mide la cantidad de alochol presente.


```{r}
summary(wine$alcohol)
```


- quality (0-10): variable cualitativa ordinal que refleja la calidad atribuida al vino.


```{r}
table(wine$quality)
```




```{r}
library(lessR)
cols = c(  "firebrick", "khaki1")
PieChart(type, data = wine, main = "Tipos de vinos",fill = cols  )
```






(variables cuantitativas)
```{r}
wine %>%
  select(2:12) %>% 
  glimpse
```

```{r}
library(ggcorrplot)
library(ggplot2)
wine %>%
  select(2:12) %>%
  na.omit(.) %>% 
  cor(.) %>% 
  ggcorrplot(., hc.order = TRUE,
        type = "lower")
```

(prefiero mil veces el siguiente, pero dejo el de arriba para que lo veais)

```{r, fig.width = 10, fig.height = 6}
library(psych)
wine %>%
  select(2:12) %>%
  na.omit(.) %>% 
  cor(.) %>% 
  corPlot(.,
       cex = 0.5
       )
```
Vamos a acompañar este cálculo con el dibujo de unos graficos de puntos de los pares de variables que presentan mayor correlación, es decir, las que tienen los valores más cercanos a 1 y -1, las cuales son `free sulfur dioxide`~`total sulfur dioxide` y density~alcohol

```{r, fig.width = 10, fig.height = 6}
wine %>%
  ggplot(aes(x=`free sulfur dioxide`,y=`total sulfur dioxide`)) +
  geom_point(size = 1,col = c( "firebrick", "khaki1")[as.integer(wine$type)],  na.rm = TRUE) + 
  geom_smooth(method = "lm",col="pink",lwd=1, alpha = 0.1) + 
  theme_bw() #+ 
  #scale_y_continuous(limits = c(0,600))
```

```{r, fig.width = 10, fig.height = 6}
wine %>%
  ggplot(aes(x=density,y=alcohol)) +
  geom_point(size = 1,col = c( "firebrick", "khaki1")[as.integer(wine$type)],na.rm = TRUE) + 
  geom_smooth(method = "lm",col="pink",lwd=1, alpha = 0.1) + 
  theme_bw() 
```

Dibujamos ahora uno del par de variables sulphates~alcohol, las cuales son las que presentan un valor de correlacion de $-0.00$ 
```{r, fig.width = 10, fig.height = 6}
wine %>%
  ggplot(aes(x=sulphates,y=alcohol)) +
  geom_point(size = 1,col = c( "firebrick", "khaki1")[as.integer(wine$type)],na.rm = TRUE) + 
  geom_smooth(method = "lm",col="pink",lwd=1, alpha = 0.1) + 
  theme_bw() 
```
(estos 3 gráficos no se si son de utilidad o que, era por ir haciendo)

(como os he dicho por whats tengo mas codigo hecho pero no me gusta y tarda mucho en runnear asi que no lo he añadido, ya me direis)
